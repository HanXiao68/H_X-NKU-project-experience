### 关键帧
#### 为什么需要关键帧keyframe
后端计算耗时，不适合处理所有的帧。
当相机停止，新信息少的帧没有必要留下。

#### 怎么选取关键帧
1. 关键帧之间不能离得太近
2. 关键帧之间不能离得太远
3. VIO中，定期选择关键帧 （假设imu的陀螺仪和加速度计的偏差在关键帧期间不变）


### 对于非关键帧，只执行前端算法，不参与后盾优化
所以，对于非关键帧，误差会逐渐积累。

### 关键帧选取策略
    在计算量允许的范围内，并且不引起退化时，应该尽可能的多插入关键帧。
    在orb slam2 中，使用的策略是：只要后端线程空闲时，就插入帧作为关键帧。多了的话，在后端剔除冗余的关键帧。
    DSO，利用光度误差插入关键帧
    
###     三角化
        对单目，为了得到landmark的深度。
  
####     数学描述

##     slam 由前端和后端组成：
            1.前端：提取特征点，追踪相机pose，定位相机。。做了keyframe到landmark之间关系的工作。
                实际操作  1.步骤： 初始化，正常追踪，丢失处理
                            2.相机和路标的建模和参数化--可能的路标：x,y z 逆深度（灰度）
            2.后端：全局优化，或滑动窗口优化。
            
            
            BA是整个地图的优化；EKF是优化单个时刻的状态。滑动窗口是介于这俩之间。
            
###   实际场合中，很难判断后端算法哪个更加优秀          
    orb-slam2使用 图优化。DSO使用带边缘化的滑动窗口，tango使用msckf（谷歌没开源） 
    实际试验效果：orbslam2 具有更好的精度，没有回环时，DSO的漂移少；tango的计算量是最少的。
    算法的结果和数据集的关系大。例如：KITTI 视野开阔，动态物体少。标定准确 （无人驾驶平台）
        euroc一般 人工设定场景，纹理丰富。曝光点大。
        tum-mono 比较难  ------场景多样，主要是真实场景。
        
##   前端的工作---VO方法的比较  sift和surf耗时最长，效果最好。光流最快，效果最差。      
    光流法最早，最成熟。PTAM，Tango
    fast + 光流是实用的快速算法。
    直接法不依赖焦点。但实现效果和选取点数量的大小关系很大。
    
    VIO要求IMU静止时初始化。
    
    特征点法 主要用角点。
    直接法 主要 先算 RT， 再算匹配。
    
    特征点提取：fast （像素的梯度比较）
                    GFTT角点   harris角点（棋盘格）
    光流法：（角点在下一帧里的变化）
        灰度不变假设（对于角点）
        
####    金字塔式光流
###   光流法在slam中的应用：
    1.光流可以追踪上一帧的角点
    2.。可以一直追踪该角点，直到超出图像范围或者被遮挡
    3.在单目slam中，新提出的角点没有3D信息，因此可以通过追踪角点在图像位置，来进行三角化，算出深度。
    
###  光流的局限
1.光照影响
2. 只适合连续图像中的短距离追踪，不适合长距离
3.图像外观发生变化时，不适用。
4.对角点强依赖。
