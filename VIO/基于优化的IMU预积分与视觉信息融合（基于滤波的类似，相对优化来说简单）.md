### 基于BA的VIO融合
已知：
    状态量的初始值：特征点的三维坐标，相机的位姿
    系统测量值：特征点在不同图像上的图像 坐标。
    
问题：如何估计状态阿玲的最优值？
    构建误差函数，利用最小二乘得到状态量的最优估计：
    投影函数和观测的差最小化，求得状态量的最优参数。（看PPT）
    使用g2o或者ceres 来求解。
    步骤：技巧性的：μ的初始值。在更新过程中，μ的更新策略（不知道什么含义，每个人的做法都不一样）；怎么构建IMU误差，设定多个信息源的权重？如何求解？
    
    IMU的精度是100hz，相机的精度是30hz，把IMU数据进行预积分，得到两个图像之间的一个数据，进行和图像的融合。
### 最小二乘问题的求解
基础：最速下降法，牛顿法
进阶：高斯牛顿法，LM算法
终极：鲁邦核函数的实现 ，又叫m估计。又是reweighted。因为权重一直在变化。
    DVO，SVO  PTAM 是吧所有的残差想统一起来
    vins 设定的因子就是1.
定义：找到一个n维变量，使得损失函数F(x) 取得局部最小值。f有可能是非线性函数。
损失函数泰勒展开：
步骤：1.找到一个合适的关于状态量的残差函数f(X), 后面用r,err等表示。
        2.计算残差函数对状态量x的雅克比 J
        3.选定cost function及其参数 
        4.麦夸特算法求解
#### 线性最小二乘求解
迭代下降法求解：下降法
迭代法初衷：
    找一个下降方向使得损失函数随x的迭代逐渐减小，直到x收敛到最优。
    1.找下降方向单位向量d。
    2.确定下降补偿a
    
最速下降法：使用于迭代的开始阶段。
            梯度的负方向是最速下降方向。缺点：最优值附近震荡
            
 牛顿法：适用于最优值附近
    
阻尼法：将损失函数的二阶泰勒最小化。 阻尼因子的选取有以下两种策略：
    麦夸特策略
    nilson策略 被g2o ceres采用 
####     非线性最小二乘
残差函数 为非线性哈数，对其一阶泰勒近似：
    j是残差函数f的雅克比矩阵。
    阻尼因子μ的取值和更新。
    
## VIO残差函数的构建          下
    视觉重投影误差
        定义：一个特征点在归一化相机坐标系下的估计值和观测值的差。像素平面麻烦点，还需要考虑相机内参。
    逆深度参数化：：特征点在归一化相机坐标系和在相机坐标系 （像素平面）下的坐标关系是：     逆深度： 1/ z
    
    预积分模型的由来和意义
    预积分方差的计算
    
    总的来说，VIO是基于滑动窗口的BA。
    VIO差函数包括：之前的误差+IMUerror + image 的error
    
    系统需要优化的状态量：PPT
        xi :第i时刻IMU的在惯性坐标系中的位置，速度，姿态，以及IMU机体坐标系中的加速度和角速度的偏置量估计。
        λ 是逆深度或者landmark（ x y z)
        逆深度参数化：特征点在归一化相机坐标系与在相机坐标系下的坐标关系。
        
####     VIO中基于逆深度的重投影误差
    特征点逆深度在第i帧中初始化得到，在第j帧又被观测到，计算其在第j帧中的坐标。
        T T T T
    从相机坐标系像素平面 位姿转换到 imu base 坐标系下。从而可以直接对结果进行积分。
       从第i时刻的PVQ对IMU的测量值进行积分得到第j  时刻的PVQ 位置 速度 旋转。
       后一个IMU点都是和前一个IMU点有关系的。前面有一个有错，后面全都出错。
       所以使用预积分。【i,j】中间的IMU点 都是直接相对于i时刻的
       预积分紧紧跟iMU测量值有关。预积分量 ---三个 位移，速度，旋转的变化量。
       
       预积分量误差的传递。包括两部分：当前时刻的误差传递给下一时刻，当前时刻的测量噪声传递给下一时刻。
       基于一阶泰勒展开的误差递推方程。状态误差 =上一时刻的  +  高斯白噪声。
       
### 残差雅克比推导
    需要相机 到IMU的外参。投过来，又投过去。
    一阶泰勒展开
    VINS直接对四元数进行操作。
    
    
##  使用LM算法来估计曲线。求解曲线中稀疏 a b  c
